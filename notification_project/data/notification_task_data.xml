<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">
        <record id="project_task_notification_template" model="mail.template">
            <field name="name">Tasks Daily Reminder</field>
            <field name="auto_delete" eval="True"/>
            <field name="model_id" ref="base.model_res_users"/>
            <field name="subject">Tasks Daily Reminder</field>
            <field name="body_html" type="html">
                <table style="width: 100%; display: table-header-group; font-weight: bold;" cellspacing="0">
                    <tr style="background-color: #ddd;">
                        <td style="display: table-cell; padding: 3px 10px; border: 1px solid #999999; width: 20%;">
                            Task
                        </td>
                        <td style="display: table-cell; padding: 3px 10px; border: 1px solid #999999; width: 16%;">
                            Deadline
                        </td>
                        <td style="display: table-cell; padding: 3px 10px; border: 1px solid #999999; width: 16%;">
                            Delay days
                        </td>
                        <td style="display: table-cell; padding: 3px 10px; border: 1px solid #999999; width: 16%;">
                            Responsible
                        </td>
                        <td style="display: table-cell; padding: 3px 10px; border: 1px solid #999999; width: 16%;">
                            Project
                        </td>
                        <td style="display: table-cell; padding: 3px 10px; border: 1px solid #999999; width: 16%;">
                            Stage
                        </td>
                    </tr>
                    % for task in ctx['task_ids']:
                    <tr style="background-color: #fff;">
                        <td style="display: table-cell; padding: 3px 10px; border: 1px solid #999999; width: 20%;">
                            <a href="${task.url_user}"><i>${task.name}</i></a>
                        </td>
                        <td style="display: table-cell; padding: 3px 10px; border: 1px solid #999999; width: 16%;">
                            % if task.date_deadline
                                ${task.date_deadline}
                            % endif
                        </td>
                        <td style="display: table-cell; padding: 3px 10px; border: 1px solid #999999; width: 16%;">
                            % if task.date_deadline
                                ${(ctx['date'].today()-task.date_deadline).days}
                            % endif
                        </td>
                        <td style="display: table-cell; padding: 3px 10px; border: 1px solid #999999; width: 16%;">
                            % if task.user_id
                                ${task.user_id.name}
                            % endif
                        </td>
                        <td style="display: table-cell; padding: 3px 10px; border: 1px solid #999999; width: 16%;">
                            % if task.project_id
                                ${task.project_id.name}
                            % endif
                        </td>
                        <td style="display: table-cell; padding: 3px 10px; border: 1px solid #999999; width: 16%;">
                            % if task.stage_id
                                ${task.stage_id.name}
                            % endif
                        </td>
                    </tr>
                    % endfor
                </table>
            </field>
        </record>
    </data>
</odoo>
